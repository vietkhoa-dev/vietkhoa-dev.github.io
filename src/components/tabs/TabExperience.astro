---
// @ts-nocheck
import { Code } from "astro:components";
import { profile } from "../../data/data.js";

const { lang = "vi" } = Astro.props;
const data = profile[lang] || profile.vi;
const careerData = data.career || [];
const ui = data.sqlUi || {};

const sqlCode = `-- [CAREER_LOG_QUERY]
-- DB_ENGINE: MariaDB 10.6

SELECT status, company, role, period
FROM professional_history
ORDER BY id ASC;

/* * LOG: Successfully fetched ${careerData.length} records */`;
---

<div class="code-container flex flex-col md:relative md:min-h-[650px] m-2 md:m-4 gap-4 md:gap-0 animate-fade-in">
  
  <div class="w-full md:absolute md:inset-0 md:z-0 md:h-[85%]">
    <div class="border border-onedark-border overflow-hidden shadow-sm flex flex-col h-full">
      <div class="bg-black/20 px-4 py-2 text-[10px] text-onedark-muted border-b border-onedark-border flex justify-between items-center">
        <span>experience.sql</span>
        <div class="flex items-center gap-2 hidden md:flex">
          <span class="w-1.5 h-1.5 bg-green-500 animate-pulse"></span>
          <span class="opacity-50 text-[9px] text-onedark-muted uppercase">DB_ONLINE</span>
        </div>
      </div>
      <div class="h-[200px] md:h-full overflow-auto p-4">
        <Code class="text-xs sm:text-sm" code={sqlCode} lang="sql" theme="one-dark-pro" />
      </div>
    </div>
  </div>

  <div class="w-full md:absolute md:z-10 md:pointer-events-none md:flex md:items-end md:justify-end md:p-8 md:translate-y-45 md:translate-x-2">
    <div class="w-full md:w-[85%] shadow-2xl md:pointer-events-auto transform hover:-translate-y-1 transition-transform duration-300">
      <div class="flex flex-col border border-white/10 overflow-hidden bg-black/95 backdrop-blur-xl">
        <div class="bg-onedark-surface px-4 py-2 border-b border-white/5 flex justify-between items-center">
          <span class="text-[10px] text-onedark-muted italic">{ui.title || ""}</span>
          <div class="flex gap-1.5">
            <div class="w-2.5 h-2.5 rounded-full bg-[#ff5f56]"></div>
            <div class="w-2.5 h-2.5 rounded-full bg-[#ffbd2e]"></div>
            <div class="w-2.5 h-2.5 rounded-full bg-[#27c93f]"></div>
          </div>
        </div>

        <div class="p-4 md:p-6 text-xs overflow-x-auto">
          <div class="max-h-60 overflow-y-auto pr-1">
            <table class="w-full text-left border-collapse min-w-[500px]">
              <thead>
                <tr class="text-primary border-b border-white/10 uppercase tracking-widest text-[9px]">
                  <th class="py-2 px-2 font-bold whitespace-nowrap">{ui.status || ""}</th>
                  <th class="py-2 px-2 font-bold">{ui.company || ""}</th>
                  <th class="py-2 px-2 font-bold">{ui.role || ""}</th>
                  <th class="py-2 px-2 font-bold">{ui.period || ""}</th>
                </tr>
              </thead>
              <tbody class="divide-y divide-white/5">
                {careerData.map((item) => (
                  <tr class="hover:bg-white/5 transition-colors group">
                    <td class="py-3 px-2">
                      <span class={`px-2 py-0.5 font-bold border text-[8px] md:text-[9px] ${item.id === 1 ? 'bg-green-500/10 text-green-400 border-green-500/20' : 'bg-white/5 text-onedark-muted border-white/10'}`}>
                        {item.status || ""}
                      </span>
                    </td>
                    <td class="py-3 px-2 text-white font-medium">{item.company || ""}</td>
                    <td class="py-3 px-2 text-onedark-muted group-hover:text-white transition-colors">{item.role || ""}</td>
                    <td class="py-3 px-2 italic text-onedark-muted/60">{item.period || ""}</td>
                  </tr>
                ))}
              </tbody>
            </table>
          </div>
          
          <div class="mt-6 pt-3 border-t border-white/5 flex justify-between items-end opacity-40">
            <div class="text-[9px] text-onedark-muted uppercase font-bold tracking-widest">Execution successful</div>
            <i class="fa-solid fa-database text-lg text-onedark-muted"></i>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>