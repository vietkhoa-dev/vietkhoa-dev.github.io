---
// @ts-nocheck
import { Code } from "astro:components";
import { profile } from "../../data/data.js";

const { lang = "vi" } = Astro.props;
const data = profile[lang] || profile.vi;
const educationData = data.education || [];
const eduText = data.eduText || {};

const dollar = "$";
const educationCode = [
  "#!/bin/bash",
  "",
  "# List of educational institutions",
  "schools=(",
  ...educationData.map(item => `  "${item.year || ""} | ${item.school || ""}"`),
  ")",
  "",
  "function render_education() {",
  `  echo "${eduText.loading || "Initializing..."}"`,
  `  for entry in "${dollar}{schools[@]}"; do`,
  `    year=$(echo ${dollar}entry | cut -d'|' -f1)`,
  `    name=$(echo ${dollar}entry | cut -d'|' -f2)`,
  `    echo "[${dollar}year] ${eduText.rendering || "Loading:"} ${dollar}name"`,
  "  done",
  "}",
  "",
  "render_education"
].join("\n");
---

<div class="code-container flex flex-col md:relative md:min-h-[650px] m-2 md:m-4 gap-4 md:gap-0 animate-fade-in">
  
  <div class="w-full md:absolute md:inset-0 md:z-0 md:h-[85%]">
    <div class="border border-onedark-border  overflow-hidden shadow-sm flex flex-col h-full">
      <div class="bg-black/20 px-4 py-2 text-[10px] text-onedark-muted border-b border-onedark-border flex justify-between items-center">
        <span>education.sh</span>
        <span class="opacity-50 italic hidden md:block uppercase tracking-widest text-[9px]">bash</span>
      </div>
      <div class="h-[250px] md:h-full overflow-auto p-4">
        <Code class="text-xs sm:text-sm" code={educationCode} lang="bash" theme="one-dark-pro" />
      </div>
    </div>
  </div>

  <div class="w-full md:absolute md:z-10 md:pointer-events-none md:flex md:items-end md:justify-end md:p-8 md:translate-y-52 md:translate-x-2">
    <div class="w-full md:w-[70%] shadow-2xl md:pointer-events-auto transform hover:-translate-y-1 transition-transform duration-300">
      <div class="flex flex-col border border-white/10  overflow-hidden bg-black/95 backdrop-blur-xl">
        <div class="bg-onedark-surface px-4 py-2 border-b border-white/5 flex justify-between items-center">
          <span class="text-[10px] text-onedark-muted italic">nvk@osaka-vps: ~</span>
          <div class="flex gap-1.5">
            <div class="w-2.5 h-2.5 rounded-full bg-[#ff5f56]"></div>
            <div class="w-2.5 h-2.5 rounded-full bg-[#ffbd2e]"></div>
            <div class="w-2.5 h-2.5 rounded-full bg-[#27c93f]"></div>
          </div>
        </div>

        <div class="p-5 md:p-6 text-xs leading-relaxed">
          <p class="text-white mb-4">
            <span class="text-green-400 font-bold">nvk@osaka</span>:<span class="text-primary">~</span>$ ./education.sh
          </p>

          <div class="space-y-4 max-h-52 overflow-y-auto pr-2 custom-scrollbar">
            <p class="text-primary italic">{eduText.loading || ""}</p>
            {educationData.map(item => (
              <div class="flex items-start gap-3 border-l-2 border-primary/20 pl-3 group">
                <span class="text-secondary font-bold min-w-[45px]">[{item.year || ""}]</span>
                <div>
                  <p class="text-zinc-100 font-bold group-hover:text-primary transition-colors leading-tight">{item.school || ""}</p>
                  <p class="text-onedark-muted text-[10px] mt-0.5 italic lowercase">> {item.status || ""}</p>
                </div>
              </div>
            ))}
          </div>

          <div class="mt-6 pt-3 border-t border-white/5 flex items-center justify-between">
            <div class="flex items-center gap-2">
              <span class="text-green-400 animate-pulse">âžœ</span>
              <p class="text-onedark-muted text-[9px] uppercase tracking-widest font-bold">{eduText.active || ""}</p>
            </div>
            <i class="fa-brands fa-linux text-onedark-muted text-xl opacity-30"></i>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>